# 生产消息<a name="zh-cn_topic_0080185214"></a>

## 操作场景<a name="section31665688"></a>

向队列中发送消息。

每条消息的大小不超过512KB（包括消息体和消息属性，消息体包括界面输入的内容和固定JSON格式部分的内容）。

使用Kafka SDK接口生产消息到Kafka队列时，单条消息最大限制为10MB。使用管理控制台生产消息到Kafka队列时，最大限制依然是512KB。

## 前提条件<a name="section16555740"></a>

已创建队列。

## 操作步骤<a name="section0152726182917"></a>

1.  登录管理控制台。
2.  在管理控制台左上角单击![](figures/icon-region.png)，选择区域。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >此处请选择与租户的应用服务相同的区域。  

3.  单击页面上方的“服务列表”，选择“应用服务 \> 分布式消息服务”，进入分布式消息服务信息页面。
4.  单击左侧菜单栏的“队列管理”，进入“队列管理”页面。
5.  打开生产消息的页面，有如下两种方式：
    -   单击队列名称后的“生产消息”，进入“生产消息”的页面。
    -   在队列详情中生产消息：
        1.  单击指定队列的名称，显示队列详情。
        2.  单击右上角的“生产消息”，进入“生产消息”页面。


6.  填写消息正文。如需添加消息标签，则输入“消息标签”。如果需要添加消息属性，输入消息属性的名称和属性值，单击“添加”，可以添加消息属性。

    **表 1**  创建消息参数说明

    <a name="table9868824195830"></a>
    <table><thead align="left"><tr id="row6064333195830"><th class="cellrowborder" valign="top" width="22.37%" id="mcps1.2.3.1.1"><p id="p58822814195830"><a name="p58822814195830"></a><a name="p58822814195830"></a>参数</p>
    </th>
    <th class="cellrowborder" valign="top" width="77.63%" id="mcps1.2.3.1.2"><p id="p67027522195830"><a name="p67027522195830"></a><a name="p67027522195830"></a>说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row66376790195830"><td class="cellrowborder" valign="top" width="22.37%" headers="mcps1.2.3.1.1 "><p id="p7810911195830"><a name="p7810911195830"></a><a name="p7810911195830"></a>消息正文</p>
    </td>
    <td class="cellrowborder" valign="top" width="77.63%" headers="mcps1.2.3.1.2 "><p id="p28704089195830"><a name="p28704089195830"></a><a name="p28704089195830"></a>发送消息的正文。</p>
    <p id="p1887110705915"><a name="p1887110705915"></a><a name="p1887110705915"></a>在Console界面发送消息时，在“消息正文”框中输入的内容都会被转义为字符串，例如："hello dms" 会转义成 \"hello dms\"。</p>
    </td>
    </tr>
    <tr id="row195653215552"><td class="cellrowborder" valign="top" width="22.37%" headers="mcps1.2.3.1.1 "><p id="p14581732115510"><a name="p14581732115510"></a><a name="p14581732115510"></a>延时消息</p>
    </td>
    <td class="cellrowborder" valign="top" width="77.63%" headers="mcps1.2.3.1.2 "><p id="p1058732175513"><a name="p1058732175513"></a><a name="p1058732175513"></a>是否开启延时消息。</p>
    <p id="p24980218579"><a name="p24980218579"></a><a name="p24980218579"></a>延时消息是指消息发送到DMS服务后，并不期望这条消息立即被消费，而是延迟一段时间后才能被消费。</p>
    <p id="p1427045155920"><a name="p1427045155920"></a><a name="p1427045155920"></a>仅普通队列可以开启延时消息，ActiveMQ队列和Kafka队列不支持延时消息的功能。</p>
    </td>
    </tr>
    <tr id="row810084212011"><td class="cellrowborder" valign="top" width="22.37%" headers="mcps1.2.3.1.1 "><p id="p2010017423016"><a name="p2010017423016"></a><a name="p2010017423016"></a>延时时长</p>
    </td>
    <td class="cellrowborder" valign="top" width="77.63%" headers="mcps1.2.3.1.2 "><p id="p01001242502"><a name="p01001242502"></a><a name="p01001242502"></a>开启延时消息时，设置延时的时长。</p>
    <p id="p35978977203121"><a name="p35978977203121"></a><a name="p35978977203121"></a>取值范围：1分钟、5分钟、30分钟、1小时或1天。</p>
    <p id="p977725918274"><a name="p977725918274"></a><a name="p977725918274"></a>默认值：5分钟。</p>
    </td>
    </tr>
    <tr id="row165141951502"><td class="cellrowborder" valign="top" width="22.37%" headers="mcps1.2.3.1.1 "><p id="p1515105110017"><a name="p1515105110017"></a><a name="p1515105110017"></a>消息标签（可选）</p>
    </td>
    <td class="cellrowborder" valign="top" width="77.63%" headers="mcps1.2.3.1.2 "><p id="p257712141219"><a name="p257712141219"></a><a name="p257712141219"></a>消息标签，即Tag，是通过对消息增加Tag来区分队列中的消息分类，DMS允许消费者按照Tag对消息进行过滤，确保消费者最终只消费到他关心的消息类型。</p>
    <p id="p185771914217"><a name="p185771914217"></a><a name="p185771914217"></a>消息标签只能包含a~z，A~Z，0-9，-，_，长度是[1，64]。</p>
    <p id="p7790737655"><a name="p7790737655"></a><a name="p7790737655"></a>最多可添加3个标签。</p>
    <p id="p172191220142212"><a name="p172191220142212"></a><a name="p172191220142212"></a>仅普通队列有消息标签，ActiveMQ队列和Kafka队列不支持消息标签的功能。</p>
    </td>
    </tr>
    <tr id="row57010216195830"><td class="cellrowborder" valign="top" width="22.37%" headers="mcps1.2.3.1.1 "><p id="p54424782195830"><a name="p54424782195830"></a><a name="p54424782195830"></a>消息属性（可选）</p>
    </td>
    <td class="cellrowborder" valign="top" width="77.63%" headers="mcps1.2.3.1.2 "><p id="p3821334318"><a name="p3821334318"></a><a name="p3821334318"></a>每条消息均可以定义消息属性，由属性名及属性值组成，以K-V的形式体现，并随消息一起被发送和消费，属于消息的一部分。</p>
    <p id="p15839125192016"><a name="p15839125192016"></a><a name="p15839125192016"></a>属性名不能为空，且一条消息中的属性名不能重复。</p>
    <p id="p587323983813"><a name="p587323983813"></a><a name="p587323983813"></a>输入属性名和属性值时，DMS会删除输入名称前后的空格，中间有空格会保留。比如将“   ab c   ”处理成“ab c”，所以对DMS来说，“   ab c   ”和“ab c”是同一个属性名称或者属性值。</p>
    <div class="note" id="note27751511123111"><a name="note27751511123111"></a><a name="note27751511123111"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p7776181118317"><a name="p7776181118317"></a><a name="p7776181118317"></a>属性名和属性值，仅在Web Console输入时前后去掉空格，使用API接口访问DMS时，不会去掉前后空格。</p>
    </div></div>
    <p id="p5442945172011"><a name="p5442945172011"></a><a name="p5442945172011"></a>消息属性的数量没限制，但您需要确保消息的大小不超过512KB，因为消息属性也是消息的一部分。</p>
    <p id="p2900171304519"><a name="p2900171304519"></a><a name="p2900171304519"></a>仅普通队列有消息属性，ActiveMQ队列和Kafka队列没有消息属性。</p>
    </td>
    </tr>
    </tbody>
    </table>

    已经添加的属性会在列表中展示，单击“删除”可以删除已经添加的属性。

7.  单击“确定”。

    在队列所在行，您可以看到消息数量增加了一条。

    如果您已经创建消费组，您可以在消费组所在行看到可消费消息数增加了一条。


